<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>File Manager - ISP Media</title>
    <link rel="stylesheet" href="../../style.css" />
  </head>
  <body>
    <!-- Navigation -->
    <div id="navbar-container"></div>

    <!-- File Manager Content -->
    <main class="container" style="padding: var(--space-8) var(--space-6)">
      <!-- File Manager Header -->
      <div class="flex justify-between items-center mb-8">
        <div>
          <h1 class="mb-2">File Manager</h1>
          <p class="text-gray">Organize and manage your media files</p>
        </div>
        <div class="flex gap-3">
          <button class="btn btn-ghost" onclick="toggleView()">
            <span id="viewIcon">⊞</span> Grid View
          </button>
          <button class="btn btn-secondary" onclick="createFolder()">
            New Folder
          </button>
          <button class="btn btn-primary" onclick="openUploadModal()">
            Upload Files
          </button>
        </div>
      </div>

      <!-- File Manager Toolbar -->
      <div class="card mb-6" style="padding: var(--space-4)">
        <div class="flex justify-between items-center">
          <!-- Breadcrumb -->
          <nav class="flex items-center gap-2">
            <a href="#" class="text-primary">Home</a>
            <span class="text-muted">></span>
            <a href="#" class="text-primary">Documents</a>
            <span class="text-muted">></span>
            <span class="text-gray">Projects</span>
          </nav>

          <!-- Search and Filters -->
          <div class="flex items-center gap-3">
            <div style="position: relative">
              <input
                type="search"
                placeholder="Search files..."
                class="form-input"
                style="width: 250px; padding-left: 35px"
              />
              <span
                style="
                  position: absolute;
                  left: 12px;
                  top: 50%;
                  transform: translateY(-50%);
                  color: var(--gray-400);
                "
                >🔍</span
              >
            </div>
            <select class="form-input" style="width: auto">
              <option>All Types</option>
              <option>Images</option>
              <option>Videos</option>
              <option>Documents</option>
              <option>Audio</option>
            </select>
          </div>
        </div>
      </div>

      <!-- File Grid -->
      <div id="fileGrid" class="file-grid">
        <!-- Folders -->
        <div class="file-item folder" onclick="openFolder('Design Assets')">
          <div class="file-icon">📁</div>
          <div class="file-info">
            <p class="file-name">Design Assets</p>
            <p class="file-meta">24 files</p>
          </div>
          <div class="file-actions">
            <button
              class="btn btn-ghost btn-sm"
              onclick="event.stopPropagation(); fileAction('rename')"
            >
              ✏️
            </button>
            <button
              class="btn btn-ghost btn-sm"
              onclick="event.stopPropagation(); fileAction('delete')"
            >
              🗑️
            </button>
          </div>
        </div>

        <div class="file-item folder" onclick="openFolder('Videos')">
          <div class="file-icon">📁</div>
          <div class="file-info">
            <p class="file-name">Videos</p>
            <p class="file-meta">12 files</p>
          </div>
          <div class="file-actions">
            <button
              class="btn btn-ghost btn-sm"
              onclick="event.stopPropagation(); fileAction('rename')"
            >
              ✏️
            </button>
            <button
              class="btn btn-ghost btn-sm"
              onclick="event.stopPropagation(); fileAction('delete')"
            >
              🗑️
            </button>
          </div>
        </div>

        <div class="file-item folder" onclick="openFolder('Documents')">
          <div class="file-icon">📁</div>
          <div class="file-info">
            <p class="file-name">Documents</p>
            <p class="file-meta">48 files</p>
          </div>
          <div class="file-actions">
            <button
              class="btn btn-ghost btn-sm"
              onclick="event.stopPropagation(); fileAction('rename')"
            >
              ✏️
            </button>
            <button
              class="btn btn-ghost btn-sm"
              onclick="event.stopPropagation(); fileAction('delete')"
            >
              🗑️
            </button>
          </div>
        </div>

        <!-- Files -->
        <div class="file-item" onclick="openFile('song1.mp3', 'audio')">
          <div class="file-icon audio">🎵</div>
          <div class="file-info">
            <p class="file-name">song1.mp3</p>
            <p class="file-meta">4.2 MB • 1 day ago</p>
          </div>
          <div class="file-actions">
            <button
              class="btn btn-ghost btn-sm"
              onclick="event.stopPropagation(); fileAction('download')"
            >
              ⬇️
            </button>
            <button
              class="btn btn-ghost btn-sm"
              onclick="event.stopPropagation(); fileAction('share')"
            >
              🔗
            </button>
            <button
              class="btn btn-ghost btn-sm"
              onclick="event.stopPropagation(); fileAction('delete')"
            >
              🗑️
            </button>
          </div>
        </div>

        <div class="file-item" onclick="openFile('album-cover.jpg', 'image')">
          <div class="file-icon image">🖼️</div>
          <div class="file-info">
            <p class="file-name">album-cover.jpg</p>
            <p class="file-meta">2.8 MB • 3 hours ago</p>
          </div>
          <div class="file-actions">
            <button
              class="btn btn-ghost btn-sm"
              onclick="event.stopPropagation(); fileAction('download')"
            >
              ⬇️
            </button>
            <button
              class="btn btn-ghost btn-sm"
              onclick="event.stopPropagation(); fileAction('share')"
            >
              🔗
            </button>
            <button
              class="btn btn-ghost btn-sm"
              onclick="event.stopPropagation(); fileAction('delete')"
            >
              🗑️
            </button>
          </div>
        </div>

        <div class="file-item" onclick="openFile('presentation.pdf')">
          >
          <div class="file-icon pdf">📄</div>
          <div class="file-info">
            <p class="file-name">presentation.pdf</p>
            <p class="file-meta">2.4 MB • 2 days ago</p>
          </div>
          <div class="file-actions">
            <button
              class="btn btn-ghost btn-sm"
              onclick="event.stopPropagation(); fileAction('download')"
            >
              ⬇️
            </button>
            <button
              class="btn btn-ghost btn-sm"
              onclick="event.stopPropagation(); fileAction('share')"
            >
              🔗
            </button>
            <button
              class="btn btn-ghost btn-sm"
              onclick="event.stopPropagation(); fileAction('delete')"
            >
              🗑️
            </button>
          </div>
        </div>

        <div class="file-item" onclick="openFile('logo-design.png')">
          <div class="file-icon image">🖼️</div>
          <div class="file-info">
            <p class="file-name">logo-design.png</p>
            <p class="file-meta">1.2 MB • 5 hours ago</p>
          </div>
          <div class="file-actions">
            <button
              class="btn btn-ghost btn-sm"
              onclick="event.stopPropagation(); fileAction('download')"
            >
              ⬇️
            </button>
            <button
              class="btn btn-ghost btn-sm"
              onclick="event.stopPropagation(); fileAction('share')"
            >
              🔗
            </button>
            <button
              class="btn btn-ghost btn-sm"
              onclick="event.stopPropagation(); fileAction('delete')"
            >
              🗑️
            </button>
          </div>
        </div>

        <div class="file-item" onclick="openFile('intro-video.mp4')">
          <div class="file-icon video">🎥</div>
          <div class="file-info">
            <p class="file-name">intro-video.mp4</p>
            <p class="file-meta">45.2 MB • 1 day ago</p>
          </div>
          <div class="file-actions">
            <button
              class="btn btn-ghost btn-sm"
              onclick="event.stopPropagation(); fileAction('download')"
            >
              ⬇️
            </button>
            <button
              class="btn btn-ghost btn-sm"
              onclick="event.stopPropagation(); fileAction('share')"
            >
              🔗
            </button>
            <button
              class="btn btn-ghost btn-sm"
              onclick="event.stopPropagation(); fileAction('delete')"
            >
              🗑️
            </button>
          </div>
        </div>

        <div class="file-item" onclick="openFile('data-analysis.xlsx')">
          <div class="file-icon excel">📊</div>
          <div class="file-info">
            <p class="file-name">data-analysis.xlsx</p>
            <p class="file-meta">890 KB • 3 days ago</p>
          </div>
          <div class="file-actions">
            <button
              class="btn btn-ghost btn-sm"
              onclick="event.stopPropagation(); fileAction('download')"
            >
              ⬇️
            </button>
            <button
              class="btn btn-ghost btn-sm"
              onclick="event.stopPropagation(); fileAction('share')"
            >
              🔗
            </button>
            <button
              class="btn btn-ghost btn-sm"
              onclick="event.stopPropagation(); fileAction('delete')"
            >
              🗑️
            </button>
          </div>
        </div>

        <div class="file-item" onclick="openFile('meeting-notes.docx')">
          <div class="file-icon word">📝</div>
          <div class="file-info">
            <p class="file-name">meeting-notes.docx</p>
            <p class="file-meta">256 KB • 1 week ago</p>
          </div>
          <div class="file-actions">
            <button
              class="btn btn-ghost btn-sm"
              onclick="event.stopPropagation(); fileAction('download')"
            >
              ⬇️
            </button>
            <button
              class="btn btn-ghost btn-sm"
              onclick="event.stopPropagation(); fileAction('share')"
            >
              🔗
            </button>
            <button
              class="btn btn-ghost btn-sm"
              onclick="event.stopPropagation(); fileAction('delete')"
            >
              🗑️
            </button>
          </div>
        </div>
      </div>

      <!-- File Manager Summary -->
      <div class="card mt-8" style="padding: var(--space-4)">
        <div class="flex justify-between items-center">
          <p class="text-sm text-muted">
            8 items • 3 folders, 5 files • 49.9 MB total
          </p>
          <div class="flex items-center gap-4 text-sm text-muted">
            <span>Storage: 12.4 GB / 50 GB used</span>
            <div
              style="
                width: 100px;
                height: 4px;
                background: var(--gray-200);
                border-radius: 2px;
                overflow: hidden;
              "
            >
              <div
                style="
                  width: 25%;
                  height: 100%;
                  background: var(--primary-color);
                "
              ></div>
            </div>
          </div>
        </div>
      </div>
    </main>
    <!-- Upload Modal (Include from modal-upload.html) -->
    <div id="uploadModal-container"></div>

    <!-- File Manager Styles -->
    <style>
      .file-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: var(--space-4);
      }

      .file-grid.list-view {
        grid-template-columns: 1fr;
      }

      .file-grid.list-view .file-item {
        flex-direction: row;
        padding: var(--space-3);
      }

      .file-grid.list-view .file-icon {
        width: 32px;
        height: 32px;
        font-size: 1rem;
        margin-bottom: 0;
        margin-right: var(--space-3);
      }

      .file-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: var(--space-5);
        background: var(--white);
        border: 1px solid var(--gray-200);
        border-radius: var(--radius-lg);
        cursor: pointer;
        transition: all var(--transition-fast);
        position: relative;
        text-align: center;
      }

      .file-item:hover {
        box-shadow: var(--shadow-md);
        transform: translateY(-2px);
      }

      .file-item.folder {
        background: var(--primary-light);
        border-color: var(--primary-color);
      }

      .file-icon {
        width: 48px;
        height: 48px;
        font-size: 2rem;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: var(--radius-lg);
        margin-bottom: var(--space-3);
      }

      .file-icon.pdf {
        background: #ff5252;
        color: white;
      }
      .file-icon.image {
        background: #4caf50;
        color: white;
      }
      .file-icon.video {
        background: #2196f3;
        color: white;
      }
      .file-icon.excel {
        background: #ff9800;
        color: white;
      }
      .file-icon.word {
        background: #9c27b0;
        color: white;
      }

      .file-info {
        flex: 1;
        min-width: 0;
      }

      .file-name {
        font-weight: 500;
        color: var(--gray-900);
        margin-bottom: var(--space-1);
        word-break: break-word;
      }

      .file-meta {
        font-size: 0.75rem;
        color: var(--gray-500);
        margin: 0;
      }

      .file-actions {
        display: flex;
        gap: var(--space-1);
        opacity: 0;
        transition: opacity var(--transition-fast);
        position: absolute;
        top: var(--space-2);
        right: var(--space-2);
      }

      .file-item:hover .file-actions {
        opacity: 1;
      }

      .file-actions .btn {
        width: 28px;
        height: 28px;
        padding: 0;
        font-size: 0.75rem;
      }

      @media (max-width: 768px) {
        .file-grid {
          grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        }

        .file-item {
          padding: var(--space-3);
        }

        .file-icon {
          width: 32px;
          height: 32px;
          font-size: 1.5rem;
        }
      }
    </style>
    <!-- Scripts -->
    <script src="../../scripts/app.js"></script>
    <script>
      let isGridView = true;

      // Load components
      fetch("/web/components/navbar.html")
        .then((response) => response.text())
        .then((html) => {
          document.getElementById("navbar-container").innerHTML = html;
        });

      fetch("modal-upload.html")
        .then((response) => response.text())
        .then((html) => {
          document.getElementById("uploadModal-container").innerHTML = html;
        });

      // File Manager Functions
      function toggleView() {
        isGridView = !isGridView;
        const grid = document.getElementById("fileGrid");
        const viewIcon = document.getElementById("viewIcon");

        if (isGridView) {
          grid.classList.remove("list-view");
          viewIcon.textContent = "☰";
          viewIcon.parentElement.innerHTML =
            '<span id="viewIcon">☰</span> List View';
        } else {
          grid.classList.add("list-view");
          viewIcon.textContent = "⊞";
          viewIcon.parentElement.innerHTML =
            '<span id="viewIcon">⊞</span> Grid View';
        }
      }

      function openFolder(folderName) {
        console.log("Opening folder:", folderName);
        // Add folder navigation logic here
      }
      function openFile(fileName, fileType) {
        console.log("Opening file:", fileName, "Type:", fileType);

        // If it's a media file, navigate to detail page
        if (
          fileType === "audio" ||
          fileType === "video" ||
          fileType === "image"
        ) {
          // Extract file ID from filename (in real app, this would be a proper ID)
          const fileId = fileName.split(".")[0];

          // Navigate to media detail page using router
          if (window.router) {
            window.router.navigateTo(`/media/${fileId}`);
          } else {
            // Fallback for non-SPA mode
            window.location.href = `/app/media/media-detail.html?id=${fileId}`;
          }
        } else {
          // For other files, show preview or download
          console.log("Opening file preview for:", fileName);
          // Add file preview/open logic here
        }
      }

      function createFolder() {
        const folderName = prompt("Enter folder name:");
        if (folderName) {
          console.log("Creating folder:", folderName);
          // Add create folder logic here
        }
      }

      function fileAction(action) {
        console.log("File action:", action);
        // Add file action logic here
      }

      function openUploadModal() {
        const modal = document.getElementById("uploadModal");
        if (modal) {
          modal.classList.remove("hidden");
        }
      }
    </script>
  </body>
</html>
